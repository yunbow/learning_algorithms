<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ボイヤー-ムーア法 (Boyer Moore)</title>
    <link rel="stylesheet" href="./../../styles.css">
</head>
<body>
    <ul class="breadcrumb">
        <li><a href="./../../">アルゴリズムの学習</a></li>
        <li><a href="./../">文字列検索の問題</a></li>
        <li>ボイヤー-ムーア法</li>
    </ul>
    <div class="container">
        <h1>ボイヤー-ムーア法 (Boyer Moore)</h1>
        <div class="section">
            <h2>アルゴリズムの概要</h2>
            <p>ボイヤームーア法は、1977年にロバート・S・ボイヤーとJ・ストロザー・ムーアによって開発された効率的な文字列検索アルゴリズムです。従来の左から右への単純な検索方法とは異なり、パターンを右から左へと照合し、不一致が発生した際には大きく検索位置をジャンプさせることで、平均的なケースで優れた性能を発揮します。</p>
            
            <h3>基礎知識</h3>
            <p>文字列検索（String Matching）とは、テキスト（長い文字列）の中から特定のパターン（短い文字列）が現れる位置をすべて見つけ出す問題です。例えば、「ABCDEFGABCDE」というテキスト内で「ABC」というパターンを検索すると、位置0と位置7に出現することがわかります。</p>
            <p>ボイヤームーア法は、「不一致が発生した場合、できるだけ多くの文字を検査せずに飛ばす」という考え方を基本としています。これにより、最悪の場合でもO(n×m)、平均的には線形時間よりも速い性能を実現できます。</p>
            
            <h3>用語説明</h3>
            <ul>
                <li><strong>テキスト（text）</strong>: 検索対象となる長い文字列</li>
                <li><strong>パターン（pattern）</strong>: テキスト内で検索したい短い文字列</li>
                <li><strong>不一致文字ヒューリスティック（Bad Character Rule）</strong>: パターンとテキストの不一致が発生した際に、どれだけ検索位置をずらすかを決めるルール</li>
                <li><strong>一致接尾辞ヒューリスティック（Good Suffix Rule）</strong>: パターンの一部が一致した場合に、その情報を利用して検索位置をずらすルール</li>
                <li><strong>検索ウィンドウ（search window）</strong>: テキスト内でパターンと照合している部分</li>
                <li><strong>シフト（shift）</strong>: 不一致が発生した際に検索ウィンドウを移動させる距離</li>
            </ul>
            
            <h3>特徴</h3>
            <p>ボイヤームーア法の主な特徴は以下の通りです：</p>
            <ul>
                <li>パターンを右から左へと照合するアプローチを採用している</li>
                <li>2つの独立したヒューリスティック（不一致文字と一致接尾辞）を併用する</li>
                <li>前処理でパターンを解析し、効率的なジャンプのための情報を記録する</li>
                <li>平均的なケースでは、テキストのすべての文字を検査する必要がなく、サブリニア時間で動作する</li>
                <li>パターンが長くなるほど、また使用する文字の種類が多いほど効率が向上する</li>
                <li>実用的な文字列検索問題において高い性能を発揮する</li>
                <li>大規模テキスト処理やバイナリデータの検索などに広く応用されている</li>
            </ul>
            
            <h3>適用ケース</h3>
            <p>ボイヤームーア法は以下のような場面で特に有用です：</p>
            <ul>
                <li>テキストエディタでの検索機能</li>
                <li>バイナリファイルやディスクイメージ内の特定パターン検索</li>
                <li>DNAシーケンス内の特定配列検索</li>
                <li>大規模なログファイル内のパターン検出</li>
                <li>データ復旧ソフトウェアでのファイルシグネチャ検索</li>
                <li>侵入検知システムでのパターンマッチング</li>
                <li>プレーンテキストデータベースでの全文検索</li>
                <li>スペルチェッカーや類似文字列検索</li>
            </ul>
        </div>
    
        <div class="section">
            <h2>アルゴリズムの手順</h2>
            <h3>具体的な手順</h3>
            <p>ボイヤームーア法の基本的な手順は以下の通りです：</p>
            <ol>
                <li><strong>前処理ステップ：</strong>
                    <ol>
                        <li>不一致文字ヒューリスティック（Bad Character Rule）の表を作成する
                            <ul>
                                <li>各文字について、パターン内での最右位置を記録する</li>
                            </ul>
                        </li>
                        <li>一致接尾辞ヒューリスティック（Good Suffix Rule）の表を作成する
                            <ul>
                                <li>パターン内の部分文字列が繰り返し現れる情報を記録する</li>
                            </ul>
                        </li>
                    </ol>
                </li>
                <li><strong>検索ステップ：</strong>
                    <ol>
                        <li>パターンの長さをmとし、検索ウィンドウをテキストの先頭からm文字分に設定する</li>
                        <li>パターンの最後の文字（インデックスm-1）からテキストとの比較を開始する</li>
                        <li>パターンの右端から左方向へと照合を続ける</li>
                        <li>不一致が発生した場合：
                            <ul>
                                <li>不一致文字ヒューリスティックによるシフト量を計算</li>
                                <li>一致接尾辞ヒューリスティックによるシフト量を計算</li>
                                <li>より大きい方のシフト量だけ検索ウィンドウを右にずらす</li>
                            </ul>
                        </li>
                        <li>完全に一致した場合は位置を記録し、検索ウィンドウを1文字分右にずらして検索を続ける</li>
                        <li>テキストの末尾に達するまで上記のプロセスを繰り返す</li>
                    </ol>
                </li>
            </ol>
            
            <h4>具体例: テキスト「ABAAABCD」内でパターン「ABC」を検索する場合</h4>
            <ol>
                <li>前処理: パターン「ABC」から不一致文字表と一致接尾辞表を作成</li>
                <li>検索開始: テキストの位置0からパターン長3の検索ウィンドウを設定</li>
                <li>比較:
                    <ul>
                        <li>パターンの最後の文字「C」とテキストの「A」を比較 → 不一致</li>
                        <li>不一致文字ヒューリスティックにより、「A」はパターン内では位置0に存在するため、シフト量は2</li>
                        <li>検索ウィンドウを2文字分右にずらす</li>
                    </ul>
                </li>
                <li>位置2からの比較:
                    <ul>
                        <li>パターンの「C」とテキストの「A」を比較 → 不一致</li>
                        <li>同様にシフト量を計算し検索を続ける</li>
                    </ul>        
                </li>
                <li>最終的に位置4からの比較で「ABC」が一致</li>
            </ol>
            
            <p>このように、不一致が発生するたびに複数の文字をスキップすることで、効率的な検索が可能になります。</p>
            
            <h3>計算量</h3>
            <p>ボイヤームーア法の計算量は以下の特性を持ちます：</p>
            <ul>
                <li><strong>前処理の時間計算量</strong>: O(m + σ)
                    <ul>
                        <li>m: パターンの長さ</li>
                        <li>σ: 使用される文字の種類数（アルファベット集合のサイズ）</li>
                    </ul>
                </li>
                <li><strong>検索の時間計算量</strong>:
                    <ul>
                        <li>最悪の場合: O(n×m) （nはテキストの長さ）</li>
                        <li>平均的な場合: O(n/m) （サブリニア時間）</li>
                        <li>最良の場合: O(n/m)</li>
                    </ul>
                </li>
                <li><strong>空間計算量</strong>: O(m + σ)</li>
            </ul>
            
            <p>ボイヤームーア法の特筆すべき点は、平均的なケースでテキストの長さに対して線形より優れた性能を示すことです。特に、パターンが長く、使用する文字の種類が多い場合に効果的です。</p>
            
            <p>実際の性能は、テキストとパターンの性質に大きく依存します。例えば、すべての文字が同じパターン（例: "AAAAA"）を検索する最悪のケースでは、基本的なブルートフォースアルゴリズムと同等の性能になりますが、一般的な自然言語テキストや実世界のデータでは非常に効率的に動作します。</p>
            
            <p>理論的には、非常に特殊なケースを除き、ボイヤームーア法は多くの文字列検索アルゴリズムの中でも優れた性能を持ち、特に長いパターンの検索において効果を発揮します。この特性から、グレップ（grep）のような検索ツールやテキストエディタの実装に広く採用されています。</p>
        </div>
    </div>
</body>
</html>