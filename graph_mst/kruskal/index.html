<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>クラスカル法 (Kruskal)</title>
    <link rel="stylesheet" href="./../../styles.css">
</head>
<body>
    <ul class="breadcrumb">
        <li><a href="./../../">アルゴリズムの学習</a></li>
        <li><a href="./../">グラフの最小全域木</a></li>
        <li>クラスカル法</li>
    </ul>

    <div class="container">
        <h1>クラスカル法 (Kruskal)</h1>
        <div class="section">
            <h2>アルゴリズムの概要</h2>
            <p>クラスカル法は、グラフ理論における最小全域木（Minimum Spanning Tree: MST）を求めるためのアルゴリズムです。1956年にジョセフ・クラスカル（Joseph Kruskal）によって発表されました。このアルゴリズムは貪欲法（グリーディアルゴリズム）の一種であり、常に局所的な最適解を選択することで全体の最適解を得ようとするアプローチです。</p>
            
            <h3>基礎知識</h3>
            <p>最小全域木（MST）とは、グラフのすべての頂点を含み、かつ辺の重みの合計が最小となる木（循環を含まないグラフ）のことを指します。例えば、都市間を結ぶ道路網で最小コストの接続方法を見つける問題などに応用できます。</p>
            <p>クラスカル法の基礎となる数学的原理は、「辺の重みが小さい順に選んでいき、循環を作らないようにすれば最適な全域木が得られる」というものです。このシンプルな原則に基づくことで、効率的に最小全域木を構築できます。</p>
            
            <h3>用語説明</h3>
            <ul>
                <li><strong>グラフ（Graph）</strong>: 頂点と辺の集合</li>
                <li><strong>頂点（Vertex）</strong>: グラフの基本要素、ノードとも呼ばれる</li>
                <li><strong>辺（Edge）</strong>: 頂点同士を結ぶ線</li>
                <li><strong>重み（Weight）</strong>: 辺に割り当てられたコストや距離などの値</li>
                <li><strong>全域木（Spanning Tree）</strong>: 元のグラフのすべての頂点を含み、循環のない連結部分グラフ</li>
                <li><strong>最小全域木（Minimum Spanning Tree）</strong>: 辺の重みの合計が最小となる全域木</li>
                <li><strong>連結成分（Connected Component）</strong>: グラフ内で互いに到達可能な頂点の集合</li>
                <li><strong>森（Forest）</strong>: 循環を持たないグラフ（複数の木の集合可能）</li>
                <li><strong>素集合データ構造（Disjoint-Set Data Structure）</strong>: 互いに素な集合を効率的に管理するデータ構造、Union-Find木とも呼ばれる</li>
            </ul>
            
            <h3>特徴</h3>
            <p>クラスカル法の主な特徴は以下の通りです：</p>
            <ul>
                <li>貪欲法（グリーディ）アプローチを採用している</li>
                <li>辺の重みに基づいてソートを行う必要がある</li>
                <li>素集合データ構造（Union-Find）を使用して循環検出を効率化できる</li>
                <li>スパースグラフ（辺が少ないグラフ）に対して特に効率的</li>
                <li>実装が比較的シンプル</li>
                <li>常に最適解（最小全域木）を保証する</li>
                <li>並列処理に適応可能</li>
                <li>グラフが非連結の場合は最小全域森（Minimum Spanning Forest）を生成する</li>
            </ul>
            
            <h3>適用ケース</h3>
            <p>クラスカル法は以下のような場面で特に有用です：</p>
            <ul>
                <li>ネットワーク設計（通信ネットワーク、電力網、水道網など）</li>
                <li>クラスタリングアルゴリズム（データマイニング、パターン認識）</li>
                <li>画像処理（セグメンテーション）</li>
                <li>回路設計</li>
                <li>交通網や配送経路の最適化</li>
                <li>生物学的ネットワーク分析（タンパク質ネットワークなど）</li>
                <li>スパースグラフにおける接続性問題</li>
                <li>並列計算環境での分散型最小全域木の構築</li>
                <li>近似ユークリッド最短経路問題</li>
            </ul>
        </div>
    
        <div class="section">
            <h2>アルゴリズムの手順</h2>
            <h3>具体的な手順</h3>
            <p>クラスカル法の基本的な手順は以下の通りです：</p>
            <ol>
                <li>グラフのすべての辺を重みの昇順でソートする</li>
                <li>各頂点を独立した連結成分（各頂点だけを含む木）とする</li>
                <li>ソートされた辺リストから最小の重みを持つ辺を一つ選択する</li>
                <li>選んだ辺の両端の頂点が既に同じ連結成分に属している場合（循環を形成する場合）は、その辺を無視して次の辺を検討する</li>
                <li>そうでなければ、その辺を最小全域木に追加し、両端の頂点の連結成分を統合する</li>
                <li>頂点数-1個の辺が選択されるか、すべての辺を検討し尽くすまでステップ3〜5を繰り返す</li>
            </ol>
            
            <p>この過程によって、最終的に最小全域木（または非連結グラフの場合は最小全域森）が構築されます。</p>
            
            <h4>具体例: 6頂点7辺のグラフでの最小全域木構築</h4>
            <p>以下のような重み付きグラフを考えます：</p>
            <ul>
                <li>辺 (A,B): 重み 4</li>
                <li>辺 (A,C): 重み 3</li>
                <li>辺 (B,C): 重み 5</li>
                <li>辺 (B,D): 重み 2</li>
                <li>辺 (C,D): 重み 6</li>
                <li>辺 (C,E): 重み 1</li>
                <li>辺 (D,E): 重み 7</li>
            </ul>
            
            <p>クラスカル法による最小全域木の構築過程：</p>
            <ol>
                <li>辺をソート: (C,E):1, (B,D):2, (A,C):3, (A,B):4, (B,C):5, (C,D):6, (D,E):7</li>
                <li>初期状態: 各頂点 A, B, C, D, E が別々の連結成分</li>
                <li>辺 (C,E):1 を選択: CとEが連結される</li>
                <li>辺 (B,D):2 を選択: BとDが連結される</li>
                <li>辺 (A,C):3 を選択: AがCとE連結成分に追加される</li>
                <li>辺 (A,B):4 を選択: すべての連結成分が統合される（A-C-EとB-Dが連結される）</li>
                <li>辺 (B,C):5 は循環を作るため無視</li>
                <li>辺 (C,D):6 は循環を作るため無視</li>
                <li>辺 (D,E):7 は循環を作るため無視</li>
            </ol>
            
            <p>最終的な最小全域木は辺 (C,E), (B,D), (A,C), (A,B) で構成され、総重みは 1+2+3+4 = 10 となります。</p>
            
            <h3>計算量</h3>
            <p>クラスカル法の計算量は以下の特性を持ちます：</p>
            <ul>
                <li><strong>時間計算量</strong>: O(E log E) または O(E log V)
                    <ul>
                        <li>E は辺の数、V は頂点の数</li>
                        <li>この計算量はグラフの辺のソートにかかる時間に支配される</li>
                        <li>素集合データ構造の各操作がほぼ定数時間で行える場合</li>
                    </ul>
                </li>
                <li><strong>空間計算量</strong>: O(E + V)
                    <ul>
                        <li>辺のリストと素集合データ構造のために必要</li>
                    </ul>
                </li>
            </ul>
            
            <p>最適化された実装では、Union-Find データ構造に「ランク付け」と「経路圧縮」を施すことで、ほぼ定数時間で連結成分の管理が可能になります。これにより、アルゴリズム全体の実行時間がさらに改善されます。</p>
            
            <p>クラスカル法は、特に辺の数が頂点数に対して少ないスパースグラフにおいて効率的です。一方、辺の数が多い密なグラフに対しては、同様に最小全域木を求めるプリム法が効率的な場合があります。</p>
            
            <p>クラスカル法の優れた特性として、グラフが非連結の場合でも、自然に最小全域森（それぞれの連結成分における最小全域木の集合）を生成できる点があります。これは、プリム法などの他のアルゴリズムでは追加の工夫が必要な機能です。</p>
        </div>
    </div>
</body>
</html>