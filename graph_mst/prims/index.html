<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>プリム法 (Prims)</title>
    <link rel="stylesheet" href="./../../styles.css">
</head>
<body>
    <ul class="breadcrumb">
        <li><a href="./../../">アルゴリズムの学習</a></li>
        <li><a href="./../">グラフの最小全域木</a></li>
        <li>プリム法</li>
    </ul>

    <div class="container">
        <h1>プリム法 (Prims)</h1>
        <div class="section">
            <h2>アルゴリズムの概要</h2>
            <p>プリム法は最小全域木（Minimum Spanning Tree: MST）を求めるための代表的なアルゴリズムで、1957年にロバート・C・プリムによって発表されました。このアルゴリズムは貪欲法に基づき、頂点を中心に考えて効率的に最小全域木を構築します。</p>
            
            <h3>基礎知識</h3>
            <p>最小全域木とは、重み付き無向グラフにおいて、すべての頂点を含み、辺の重みの総和が最小となる木（閉路を持たない連結部分グラフ）のことを指します。例えば、都市間を結ぶ道路網で、すべての都市を最小コストで接続するための道路の組み合わせを求める問題です。</p>
            <p>プリム法の基礎となる数学的原理は、「各ステップで、現在の部分木に隣接する辺のうち、最小の重みを持つ辺を選択する」という貪欲的なアプローチです。これを繰り返すことで、最終的に最小全域木が得られます。</p>
            
            <h3>用語説明</h3>
            <ul>
                <li><strong>グラフ（Graph）</strong>: 頂点と辺の集合</li>
                <li><strong>頂点（Vertex）</strong>: グラフの基本構成要素、ノードとも呼ばれる</li>
                <li><strong>辺（Edge）</strong>: 頂点同士を結ぶ線</li>
                <li><strong>重み（Weight）</strong>: 辺に割り当てられた数値（コストや距離など）</li>
                <li><strong>全域木（Spanning Tree）</strong>: グラフのすべての頂点を含み、閉路を持たない連結部分グラフ</li>
                <li><strong>最小全域木（Minimum Spanning Tree）</strong>: 辺の重みの総和が最小となる全域木</li>
                <li><strong>貪欲法（Greedy Algorithm）</strong>: 各ステップで局所的に最適な選択を行う問題解決手法</li>
                <li><strong>優先度キュー（Priority Queue）</strong>: 優先度（この場合は辺の重み）に基づいて要素を取り出すデータ構造</li>
            </ul>
            
            <h3>特徴</h3>
            <p>プリム法の主な特徴は以下の通りです：</p>
            <ul>
                <li>頂点中心のアプローチ：単一の頂点から開始し、徐々に木を拡張する</li>
                <li>貪欲法に基づいており、各ステップで局所的に最適な選択を行う</li>
                <li>優先度キューを用いた効率的な実装が可能</li>
                <li>密なグラフ（辺が多いグラフ）で特に効率的</li>
                <li>対象が連結グラフである必要がある（非連結グラフでは各連結成分に対して別々に適用する必要がある）</li>
                <li>クラスカル法と並んで最小全域木問題の代表的な解法</li>
                <li>動的に変化するグラフに対応しやすい（頂点追加時の更新が容易）</li>
            </ul>
            
            <h3>適用ケース</h3>
            <p>プリム法は以下のような場面で特に有用です：</p>
            <ul>
                <li>ネットワーク設計（電気、通信、水道などのインフラ整備）</li>
                <li>道路網や鉄道網などの交通インフラの最適設計</li>
                <li>クラスタリングやデータマイニングにおける最小連結問題</li>
                <li>回路設計における最小配線問題</li>
                <li>コンピュータネットワークのルーティング最適化</li>
                <li>画像処理における領域分割</li>
                <li>系統樹（系統発生学）の構築</li>
                <li>密なグラフにおける最小コスト接続問題全般</li>
            </ul>
        </div>
    
        <div class="section">
            <h2>アルゴリズムの手順</h2>
            <h3>具体的な手順</h3>
            <p>プリム法の基本的な手順は以下の通りです：</p>
            <ol>
                <li>グラフの任意の頂点を選び、最小全域木の初期状態とする</li>
                <li>現在の木に隣接するすべての辺を考慮する</li>
                <li>それらの辺の中から、まだ木に含まれていない頂点へつながる最小重みの辺を選択する</li>
                <li>選択した辺とその先の頂点を木に追加する</li>
                <li>グラフのすべての頂点が木に含まれるまで、ステップ2〜4を繰り返す</li>
            </ol>
            
            <p>実装では、効率化のために優先度キューを用いることが一般的です。具体的な実装手順は以下のようになります：</p>
            <ol>
                <li>すべての頂点を「未訪問」としてマークし、各頂点への最小コストを無限大に初期化する</li>
                <li>任意の開始頂点を選び、そのコストを0に設定する</li>
                <li>優先度キューに開始頂点を挿入する</li>
                <li>優先度キューが空になるまで以下を繰り返す：
                    <ol type="a">
                        <li>優先度キューから最小コストの頂点uを取り出す</li>
                        <li>頂点uを「訪問済み」としてマークする</li>
                        <li>頂点uのすべての隣接頂点vについて、もしvが「未訪問」でuからvへの辺の重みが現在のvへのコストより小さければ、vへのコストと親を更新し、vを優先度キューに挿入する</li>
                    </ol>
                </li>
            </ol>
            
            <h4>具体例: 5頂点のグラフにプリム法を適用する場合</h4>
            <p>以下のような5頂点の重み付きグラフを考えます：</p>
            <ul>
                <li>辺(A,B)の重み: 2</li>
                <li>辺(A,C)の重み: 3</li>
                <li>辺(B,C)の重み: 1</li>
                <li>辺(B,D)の重み: 4</li>
                <li>辺(C,D)の重み: 5</li>
                <li>辺(C,E)の重み: 6</li>
                <li>辺(D,E)の重み: 2</li>
            </ul>
            
            <p>ステップバイステップの実行：</p>
            <ol>
                <li>頂点Aから開始する（コスト = 0）</li>
                <li>Aの隣接頂点BとCを調べ、最小辺(A,B)を選択（コスト = 2）</li>
                <li>BとCの隣接頂点を調べ、最小辺(B,C)を選択（コスト = 1）</li>
                <li>CとDの隣接頂点を調べ、最小辺(B,D)を選択（コスト = 4）</li>
                <li>DとEの隣接頂点を調べ、最小辺(D,E)を選択（コスト = 2）</li>
            </ol>
            
            <p>最終的な最小全域木は辺{(A,B), (B,C), (B,D), (D,E)}で構成され、総コストは2+1+4+2=9となります。</p>
            
            <h3>計算量</h3>
            <p>プリム法の計算量は実装方法と使用するデータ構造によって異なります：</p>
            <ul>
                <li><strong>時間計算量</strong>:
                    <ul>
                        <li>単純な配列実装: O(V²)（Vは頂点数）</li>
                        <li>二分ヒープ（優先度キュー）を使用した実装: O((V+E)logV)（Eは辺数）</li>
                        <li>フィボナッチヒープを使用した理論的な最適実装: O(E + VlogV)</li>
                    </ul>
                </li>
                <li><strong>空間計算量</strong>: O(V + E)</li>
            </ul>
            
            <p>使用するデータ構造の選択はグラフの特性に依存します：</p>
            <ul>
                <li>密なグラフ（E ≈ V²）では単純な配列実装が効率的な場合がある</li>
                <li>疎なグラフ（E 《 V²）では優先度キューを使用した実装が有利</li>
            </ul>
            
            <p>クラスカル法（辺をソートして最小の辺から順に選ぶ方法）と比較すると、プリム法は密なグラフで優れた性能を発揮します。一方、クラスカル法は疎なグラフで効率的です。実際の応用では、グラフの特性に応じて適切なアルゴリズムを選択することが重要です。</p>
            
            <p>優先度キューの効率的な実装により、プリム法は非常に大規模なグラフに対しても実用的な時間内で最小全域木を構築できるため、現実世界の大規模ネットワーク設計問題において広く利用されています。</p>
        </div>
    </div>
</body>
</html>