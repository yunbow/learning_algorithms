<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ソロベイ-シュトラッセン法 (Solovay-Strassen)</title>
    <link rel="stylesheet" href="./../../styles.css">
</head>
<body>
    <ul class="breadcrumb">
        <li><a href="./../../">アルゴリズムの学習</a></li>
        <li><a href="./../">素数判定の問題</a></li>
        <li>ソロベイ-シュトラッセン法</li>
    </ul>
    <div class="container">
        <h1>ソロベイ-シュトラッセン法 (Solovay-Strassen)</h1>
        <div class="section">
            <h2>アルゴリズムの概要</h2>
            <p>ソロベイ-シュトラッセン法は1977年にロバート・ソロベイとフォルカー・シュトラッセンによって開発された確率的素数判定アルゴリズムです。このアルゴリズムは、大きな数が素数であるかどうかを高い確率で判定することができます。完全に決定的ではなく確率的であるため、「おそらく素数」という結論を得ることができますが、誤りの可能性は実行回数を増やすことで極めて小さくすることが可能です。</p>
            
            <h3>基礎知識</h3>
            <p>素数とは、1とその数自身以外に約数を持たない自然数のことです。素数判定は、与えられた数が素数かどうかを判定する問題です。</p>
            <p>ソロベイ-シュトラッセン法は、オイラーの判定基準とヤコビ記号の性質を利用します。具体的には、フェルマーの小定理の一般化であるオイラーの判定基準と、ルジャンドル記号を拡張したヤコビ記号を組み合わせて、素数の特性を確率的に検証します。</p>
            
            <h3>用語説明</h3>
            <ul>
                <li><strong>確率的アルゴリズム（probabilistic algorithm）</strong>: 結果が確率的に正しいアルゴリズム</li>
                <li><strong>オイラーの判定基準（Euler's criterion）</strong>: 平方剰余に関する定理で、a^((p-1)/2) ≡ (a/p) (mod p) を満たす</li>
                <li><strong>ヤコビ記号（Jacobi symbol）</strong>: ルジャンドル記号を拡張した概念で、(a/n)と表記される</li>
                <li><strong>ルジャンドル記号（Legendre symbol）</strong>: (a/p)と表記され、aがpを法として平方剰余かどうかを示す</li>
                <li><strong>モジュラ累乗（modular exponentiation）</strong>: 累乗計算を剰余演算と組み合わせる演算</li>
                <li><strong>平方剰余（quadratic residue）</strong>: あるモジュロの下で平方数となる数</li>
                <li><strong>偽素数（pseudoprime）</strong>: 素数判定テストにパスするが実際は合成数である数</li>
                <li><strong>オイラー偽素数（Euler pseudoprime）</strong>: オイラーの判定基準を満たす合成数</li>
            </ul>
            
            <h3>特徴</h3>
            <p>ソロベイ-シュトラッセン法の主な特徴は以下の通りです：</p>
            <ul>
                <li>確率的な素数判定法であり、誤りの可能性がある（ただし、その確率は制御可能）</li>
                <li>数論的な性質（特にオイラーの判定基準とヤコビ記号）に基づいている</li>
                <li>モンテカルロ法の一種で、「おそらく素数」という結論を提供</li>
                <li>判定対象が合成数の場合は高い確率でそれを検出できる</li>
                <li>複数回の独立したテストを実行することで、誤判定の確率を指数関数的に減少させることが可能</li>
                <li>ミラー-ラビン素数判定法よりも理論的な基盤が複雑だが、歴史的に重要な方法</li>
                <li>大きな数に対して効率的に動作する</li>
            </ul>
            
            <h3>適用ケース</h3>
            <p>ソロベイ-シュトラッセン法は以下のような場面で特に有用です：</p>
            <ul>
                <li>暗号理論における大きな素数の生成（RSA暗号など）</li>
                <li>素因数分解や安全な鍵生成のための前処理</li>
                <li>素数密度の研究や分布の分析</li>
                <li>確定的な方法では計算コストが高すぎる大きな数の素数判定</li>
                <li>高速な素数判定が必要な数論的アプリケーション</li>
                <li>教育目的での数論や確率的アルゴリズムの説明</li>
                <li>乱数の品質検証や素数生成アルゴリズムのテスト</li>
            </ul>
        </div>
    
        <div class="section">
            <h2>アルゴリズムの手順</h2>
            <h3>具体的な手順</h3>
            <p>ソロベイ-シュトラッセン法の基本的な手順は以下の通りです：</p>
            <ol>
                <li>判定したい奇数nが与えられる（n > 2）</li>
                <li>nが偶数または1以下の場合、素数ではないと判定して終了</li>
                <li>繰り返し回数kを決定する（kが大きいほど誤判定の確率が低下）</li>
                <li>以下のテストをk回繰り返す：
                    <ol type="a">
                        <li>1からn-1までの範囲でランダムな整数aを選ぶ</li>
                        <li>aとnの最大公約数をgcd(a,n)で計算する</li>
                        <li>もしgcd(a,n) > 1ならば、nは合成数と判定して終了</li>
                        <li>そうでなければ、a^((n-1)/2) mod nを計算する</li>
                        <li>また、ヤコビ記号(a/n)を計算する</li>
                        <li>もしa^((n-1)/2) mod n ≠ (a/n) mod nならば、nは合成数と判定して終了</li>
                    </ol>
                </li>
                <li>すべてのテストをパスした場合、nは確率的に素数（おそらく素数）と判定する</li>
            </ol>
            
            <p>k回のテストすべてをパスした場合、nが合成数である確率は最大でも(1/2)^kとなります。つまり、テスト回数kを増やすことで、誤判定の確率を非常に小さくすることができます。</p>
            
            <h4>具体例: n = 17の素数判定</h4>
            <ol>
                <li>n = 17（奇数で2より大きい）</li>
                <li>k = 3として3回のテストを実行するとする</li>
                <li>テスト1:
                    <ol type="a">
                        <li>a = 2をランダムに選ぶ</li>
                        <li>gcd(2,17) = 1（互いに素）</li>
                        <li>2^((17-1)/2) = 2^8 = 256 ≡ 1 (mod 17)</li>
                        <li>ヤコビ記号(2/17) = 1（実際の計算は省略）</li>
                        <li>1 = 1なので、テスト1はパス</li>
                    </ol>
                </li>
                <li>テスト2とテスト3も同様に実行し、すべてパスしたとする</li>
                <li>結論: 17はおそらく素数（実際に17は素数）</li>
            </ol>
            
            <h3>計算量</h3>
            <p>ソロベイ-シュトラッセン法の計算量は以下の特性を持ちます：</p>
            <ul>
                <li><strong>時間計算量</strong>: O(k × log³(n))
                    <ul>
                        <li>kはテストの繰り返し回数</li>
                        <li>主要な計算負荷はモジュラ累乗演算とヤコビ記号の計算</li>
                        <li>モジュラ累乗: O(log²(n))</li>
                        <li>ヤコビ記号計算: O(log²(n))</li>
                    </ul>
                </li>
                <li><strong>空間計算量</strong>: O(log(n))
                    <ul>
                        <li>nを表現するのに必要なビット数に比例</li>
                        <li>追加でのメモリ使用は最小限</li>
                    </ul>
                </li>
            </ul>
            
            <p>この計算量から、ソロベイ-シュトラッセン法は大きな数に対しても効率的に動作することがわかります。確率的手法の利点は、確定的なアルゴリズムの計算量O(n^(1/2))よりも大幅に効率的であるという点です。</p>
            
            <p>また、誤判定の確率は(1/2)^kで上限づけられるため、例えばk=50とすると誤判定の確率は2^(-50)≈10^(-15)となり、実用上は問題のないレベルまで低減できます。</p>
            
            <p>ただし、より高度な確率的素数判定法であるミラー-ラビン法の方が誤判定率の上界が低いため、現代の多くの暗号システムではミラー-ラビン法が好まれる傾向にあります。それでも、ソロベイ-シュトラッセン法は数論的に重要なアルゴリズムとして、理論的および教育的な価値を持ち続けています。</p>
        </div>
    </div>
</body>
</html>