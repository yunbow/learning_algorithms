<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>試し割り法 (Trial Division)</title>
    <link rel="stylesheet" href="./../../styles.css">
</head>
<body>
    <ul class="breadcrumb">
        <li><a href="./../../">アルゴリズムの学習</a></li>
        <li><a href="./../">素数判定の問題</a></li>
        <li>試し割り法</li>
    </ul>

    <div class="container">
        <h1>試し割り法 (Trial Division)</h1>
        <div class="section">
            <h2>アルゴリズムの概要</h2>
            <p>試し割り法は、与えられた数が素数であるかどうかを判定する最も単純で直感的なアルゴリズムです。ある数が素数であるかどうかを、より小さい数で割り切れるかどうかを確認することによって判定します。このアルゴリズムは理解しやすく実装も容易ですが、大きな数に対しては効率が低下するという特性があります。</p>
            
            <h3>基礎知識</h3>
            <p>素数とは、1と自分自身以外に約数を持たない1より大きい自然数のことです。言い換えれば、2つの自然数の積として表すことができない数が素数です。最小の素数は2で、他にも3、5、7、11、13などが素数にあたります。</p>
            <p>試し割り法の基本的な考え方は、数学的な素数の定義に直接基づいています。ある数nが素数であるかを判定するためには、2からn-1までの全ての数でnを割り、すべての場合で余りが出るかどうかを確認します。一つでも割り切れる数があれば、その数は素数ではありません。</p>
            <p>ただし、効率化のためにいくつかの最適化が可能です。例えば、nの平方根までの数だけを調べれば十分であることが数学的に証明されています。これにより、チェックするべき数の範囲を大幅に減らすことができます。</p>
            
            <h3>用語説明</h3>
            <ul>
                <li><strong>素数（prime number）</strong>: 1と自分自身以外に約数を持たない1より大きい自然数</li>
                <li><strong>合成数（composite number）</strong>: 素数ではない1より大きい自然数（つまり、1と自分自身以外の約数を持つ数）</li>
                <li><strong>約数（divisor）</strong>: ある数を割り切ることができる数</li>
                <li><strong>倍数（multiple）</strong>: ある数に整数を掛けて得られる数</li>
                <li><strong>余り（remainder）</strong>: 割り算の結果の小数部分</li>
                <li><strong>試し割り（trial division）</strong>: 候補となる約数で実際に割ってみる操作</li>
                <li><strong>素因数分解（prime factorization）</strong>: 数を素数の積として表すこと</li>
                <li><strong>平方根（square root）</strong>: ある数を2乗すると元の数になるような数</li>
            </ul>
            
            <h3>特徴</h3>
            <p>試し割り法の主な特徴は以下の通りです：</p>
            <ul>
                <li>最も基本的で直感的な素数判定アルゴリズム</li>
                <li>実装が非常に容易</li>
                <li>小さな数に対しては十分に効率的</li>
                <li>平方根までの数だけをチェックすることで最適化可能</li>
                <li>偶数の特別扱い（2を除く偶数は素数でない）による更なる最適化が可能</li>
                <li>大きな数に対しては計算効率が悪い</li>
                <li>確定的なアルゴリズム（結果が100%正確）</li>
                <li>素数判定だけでなく、素因数分解にも応用可能</li>
                <li>並列化が容易（複数の約数候補を同時にチェック可能）</li>
            </ul>
            
            <h3>適用ケース</h3>
            <p>試し割り法は以下のような場面で特に有用です：</p>
            <ul>
                <li>比較的小さな数（数百万程度まで）の素数判定</li>
                <li>教育目的での素数の概念理解</li>
                <li>素数表の生成（エラトステネスのふるいと組み合わせて使われることが多い）</li>
                <li>簡易的な素因数分解</li>
                <li>数論の基本的な問題解決</li>
                <li>暗号化の基礎概念理解（RSA暗号などでは大きな素数が使われる）</li>
                <li>計算リソースが限られた環境での素数判定</li>
                <li>アルゴリズムの正確性が最優先される場合</li>
                <li>特定の数が素数かどうかの単純な確認が必要な場合</li>
            </ul>
        </div>
    
        <div class="section">
            <h2>アルゴリズムの手順</h2>
            <h3>具体的な手順</h3>
            <p>試し割り法の基本的な手順は以下の通りです：</p>
            
            <h4>1. 基本的な試し割り法</h4>
            <ol>
                <li>判定対象の数nを入力として受け取る</li>
                <li>nが2未満の場合：
                    <ul>
                        <li>nが2未満なら素数ではないと判定（1は素数ではない）</li>
                    </ul>
                </li>
                <li>nが2の場合：
                    <ul>
                        <li>2は素数であると判定</li>
                    </ul>
                </li>
                <li>nが2より大きい場合：
                    <ul>
                        <li>2からn-1までの各数iについて：
                            <ul>
                                <li>nがiで割り切れるかチェック（n % i == 0）</li>
                                <li>もし割り切れれば、nは素数ではないと判定して終了</li>
                            </ul>
                        </li>
                        <li>どの数でも割り切れなかった場合、nは素数であると判定</li>
                    </ul>
                </li>
            </ol>
            
            <h4>2. 平方根最適化を適用した試し割り法</h4>
            <ol>
                <li>判定対象の数nを入力として受け取る</li>
                <li>nが2未満の場合：
                    <ul>
                        <li>nが2未満なら素数ではないと判定</li>
                    </ul>
                </li>
                <li>nが2の場合：
                    <ul>
                        <li>2は素数であると判定</li>
                    </ul>
                </li>
                <li>nが2より大きい場合：
                    <ul>
                        <li>nの平方根（√n）を計算</li>
                        <li>2から√nまでの各数iについて：
                            <ul>
                                <li>nがiで割り切れるかチェック（n % i == 0）</li>
                                <li>もし割り切れれば、nは素数ではないと判定して終了</li>
                            </ul>
                        </li>
                        <li>どの数でも割り切れなかった場合、nは素数であると判定</li>
                    </ul>
                </li>
            </ol>
            
            <h4>3. さらに最適化した試し割り法</h4>
            <ol>
                <li>判定対象の数nを入力として受け取る</li>
                <li>nが2未満の場合：
                    <ul>
                        <li>nが2未満なら素数ではないと判定</li>
                    </ul>
                </li>
                <li>nが2の場合：
                    <ul>
                        <li>2は素数であると判定</li>
                    </ul>
                </li>
                <li>nが3の場合：
                    <ul>
                        <li>3は素数であると判定</li>
                    </ul>
                </li>
                <li>nが偶数の場合：
                    <ul>
                        <li>nは素数ではないと判定（2以外の偶数は素数ではない）</li>
                    </ul>
                </li>
                <li>nがここまでの条件に該当しない場合（5以上の奇数）：
                    <ul>
                        <li>nの平方根（√n）を計算</li>
                        <li>iを3に初期化し、iが√n以下である限り、以下を繰り返す：
                            <ul>
                                <li>nがiで割り切れるかチェック（n % i == 0）</li>
                                <li>もし割り切れれば、nは素数ではないと判定して終了</li>
                                <li>iを2増加させる（奇数のみをチェック）</li>
                            </ul>
                        </li>
                        <li>どの数でも割り切れなかった場合、nは素数であると判定</li>
                    </ul>
                </li>
            </ol>
            
            <h4>素因数分解への応用</h4>
            <ol>
                <li>分解対象の数nを入力として受け取る</li>
                <li>素因数のリストを空のリストとして初期化</li>
                <li>nが1になるまで以下を繰り返す：
                    <ul>
                        <li>iを2に初期化</li>
                        <li>nの平方根（√n）を計算</li>
                        <li>iが√n以下かつnがまだ1より大きい限り：
                            <ul>
                                <li>nがiで割り切れる間は以下を繰り返す：
                                    <ul>
                                        <li>iを素因数リストに追加</li>
                                        <li>nをn/iで更新</li>
                                    </ul>
                                </li>
                                <li>iを1増加させる</li>
                            </ul>
                        </li>
                        <li>もしnがまだ1より大きければ、nを素因数リストに追加（最後の素因数）</li>
                    </ul>
                </li>
                <li>素因数のリストを結果として返す</li>
            </ol>
    
            <h3>計算量</h3>
            <p>試し割り法アルゴリズムの計算量は以下の通りです：</p>
            
            <h4>時間計算量</h4>
            <ul>
                <li><strong>基本的な試し割り法</strong>: O(n) - 2からn-1までの約n-2回の除算操作</li>
                <li><strong>平方根最適化版</strong>: O(√n) - 2から√nまでの約√n-1回の除算操作</li>
                <li><strong>さらに最適化版（偶数スキップ）</strong>: O(√n) - ただし定数倍の改善がある</li>
            </ul>
            
            <h4>空間計算量</h4>
            <ul>
                <li><strong>すべての実装</strong>: O(1) - 入力サイズに関係なく一定の追加メモリのみ使用</li>
                <li><strong>素因数分解への応用</strong>: O(log n) - 最悪の場合、素因数のリストのサイズ</li>
            </ul>
            
            <p>試し割り法の計算量を理解する上で重要なのは、平方根最適化の効果です。例えば、100万の素数判定を行う場合、基本的な方法では約100万回の除算が必要ですが、平方根最適化版では約1,000回の除算で済みます。これは3桁のオーダーの差があります。</p>
            
            <p>しかし、数が大きくなるにつれて試し割り法の効率は急速に低下します。例えば、20桁の数の素数判定には、平方根最適化版でも約10^10回の除算操作が必要になり、現実的な時間で計算することが難しくなります。このため、大きな数の素数判定には、ミラー・ラビン素数判定法やソロベイ・シュトラッセン素数判定法などの確率的アルゴリズムが用いられます。</p>
            
            <p>また、素因数分解への応用に関しては、最悪の場合の時間計算量はO(√n)ですが、実際の挙動は入力の性質に強く依存します。例えば、大きな素数の積で構成される半素数（2つの素数の積）の分解は、試し割り法では非常に困難です。このような特性は、RSA暗号などの公開鍵暗号方式の安全性の基盤となっています。</p>
        </div>
    </div>
</body>
</html>