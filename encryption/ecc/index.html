<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECC (Elliptic Curve Cryptography)</title>
    <link rel="stylesheet" href="./../../styles.css">
</head>
<body>
    <ul class="breadcrumb">
        <li><a href="./../../">アルゴリズムの学習</a></li>
        <li><a href="./../">暗号化・複合化の問題</a></li>
        <li>ECC</li>
    </ul>

    <div class="container">
        <h1>ECC (Elliptic Curve Cryptography)</h1>
        <div class="section">
            <h2>アルゴリズムの概要</h2>
            <p>楕円曲線暗号（ECC: Elliptic Curve Cryptography）は、楕円曲線上の点群が持つ代数的構造を利用した公開鍵暗号システムです。1985年にニール・コブリッツとビクター・ミラーによって独立に提案されました。従来のRSA暗号などと比較して、同等のセキュリティレベルをより短い鍵長で実現できることが大きな特徴です。</p>
            
            <h3>基礎知識</h3>
            <p>楕円曲線暗号の基盤となるのは、楕円曲線上の点の演算に関する離散対数問題の難しさです。楕円曲線は一般的に「y² = x³ + ax + b」という形式で表される方程式で定義され、この曲線上の点に対して定義される「加算」演算と「スカラー倍算」演算が暗号の基礎となります。特に、ある点Pと整数kが与えられたとき、Q = kPを計算するのは容易ですが、逆にPとQが与えられたときにkを求める問題（楕円曲線離散対数問題：ECDLP）は計算量的に難しいとされています。</p>
            <p>楕円曲線暗号では、この性質を利用して暗号化や電子署名などの暗号プロトコルを構築します。現代では、IoTデバイスやモバイル機器など、計算資源やバンド幅が限られた環境でも効率的に動作する暗号方式として広く採用されています。また、量子コンピュータに対する耐性が従来の素因数分解に基づく暗号方式よりも高いとされており、ポスト量子時代においても一定期間は安全性が保たれると考えられています。</p>
            
            <h3>用語説明</h3>
            <ul>
                <li><strong>楕円曲線（Elliptic Curve）</strong>: 「y² = x³ + ax + b」の形で表される数学的曲線（mod pで計算する場合もある）</li>
                <li><strong>点の加算（Point Addition）</strong>: 楕円曲線上の2点から第3の点を導出する演算</li>
                <li><strong>スカラー倍算（Scalar Multiplication）</strong>: 楕円曲線上の点を整数回加算する演算（kP = P + P + ... + P（k回））</li>
                <li><strong>無限遠点（Point at Infinity）</strong>: 楕円曲線上の加法単位元として機能する特殊な点</li>
                <li><strong>位数（Order）</strong>: 楕円曲線上の点の集合の要素数</li>
                <li><strong>基点（Base Point）</strong>: 暗号操作の起点となる楕円曲線上の特定の点G</li>
                <li><strong>秘密鍵（Private Key）</strong>: ユーザーが保持する秘密の整数値d</li>
                <li><strong>公開鍵（Public Key）</strong>: 秘密鍵から生成される楕円曲線上の点Q（Q = dG）</li>
                <li><strong>楕円曲線離散対数問題（ECDLP）</strong>: 楕円曲線上の点PとQ = kPが与えられたときにkを求める計算困難な問題</li>
                <li><strong>楕円曲線ドメインパラメータ</strong>: 楕円曲線の方程式の係数や基点などを含む、暗号システムの設定パラメータ群</li>
                <li><strong>有限体（Finite Field）</strong>: 楕円曲線の計算が行われる数学的構造（通常は素数体GF(p)または2の冪体GF(2^m)）</li>
                <li><strong>ECDH（Elliptic Curve Diffie-Hellman）</strong>: 楕円曲線を用いた鍵共有プロトコル</li>
                <li><strong>ECDSA（Elliptic Curve Digital Signature Algorithm）</strong>: 楕円曲線を用いたデジタル署名アルゴリズム</li>
            </ul>
            
            <h3>特徴</h3>
            <p>楕円曲線暗号の主な特徴は以下の通りです：</p>
            <ul>
                <li>小さな鍵サイズで高い安全性を提供（256ビットのECCは3072ビットのRSAと同等のセキュリティ）</li>
                <li>計算効率が良く、特に検証や暗号化処理が高速</li>
                <li>メモリ使用量や通信帯域の節約が可能</li>
                <li>モバイルやIoTデバイスなどの制約のある環境に適している</li>
                <li>量子コンピュータに対する耐性がRSAなどより相対的に高い</li>
                <li>様々な暗号プロトコル（署名、鍵交換、暗号化など）に応用可能</li>
                <li>楕円曲線の選択により安全性と効率性をカスタマイズできる</li>
                <li>国際的な標準化が進んでおり、多くの暗号規格で採用されている</li>
                <li>複数の安全なパラメータセットが標準化されている（NIST曲線、Brainpool曲線など）</li>
                <li>ブロックチェーンや現代の多くの暗号通信プロトコルで広く使用されている</li>
            </ul>
            
            <h3>適用ケース</h3>
            <p>楕円曲線暗号は以下のような場面で特に有用です：</p>
            <ul>
                <li>スマートカードやICカードなどの制約のあるデバイスでの認証</li>
                <li>モバイルデバイスやIoT機器でのセキュアな通信</li>
                <li>TLS/SSLプロトコルにおける鍵交換や認証</li>
                <li>ブロックチェーン技術におけるデジタル署名（Bitcoin、Ethereumなど）</li>
                <li>電子政府システムにおける本人認証や文書署名</li>
                <li>VPNや無線ネットワークのセキュリティプロトコル</li>
                <li>企業間の安全なデータ交換システム</li>
                <li>電子メール暗号化（S/MIME、PGP）</li>
                <li>デジタル著作権管理（DRM）システム</li>
                <li>高速な認証が必要なオンラインサービス</li>
                <li>バッテリー寿命が重要な組み込みシステム</li>
                <li>帯域幅が制限された衛星通信やセンサーネットワーク</li>
            </ul>
        </div>
    
        <div class="section">
            <h2>アルゴリズムの手順</h2>
            <h3>具体的な手順</h3>
            <p>楕円曲線暗号システムの構築と利用には、以下の主要な手順が含まれます：</p>
            
            <h4>1. セットアップフェーズ（システムパラメータの設定）</h4>
            <ol>
                <li>適切な楕円曲線を選択する：
                    <ul>
                        <li>安全な素数p（または2のべき乗）を選び、有限体Fp（またはF2^m）を決定する</li>
                        <li>楕円曲線方程式のパラメータa, bを選び、y² = x³ + ax + b mod pの形式で曲線を定義する</li>
                        <li>曲線の位数（曲線上の点の総数）がセキュリティ要件を満たすことを確認する</li>
                        <li>大きな素数位数を持つ部分群を生成する基点Gを選択する</li>
                        <li>基点Gの位数nを計算する（最小の正整数nでnG = O（無限遠点）となるもの）</li>
                    </ul>
                </li>
                <li>ドメインパラメータを公開する：
                    <ul>
                        <li>D = (p, a, b, G, n, h)の形式で公開（hは余因子で、曲線の全体の位数を基点の位数で割った値）</li>
                        <li>標準化された曲線パラメータ（NIST P-256など）を使用することも一般的</li>
                    </ul>
                </li>
            </ol>
            
            <h4>2. 鍵生成（Key Generation）</h4>
            <ol>
                <li>秘密鍵の生成：
                    <ul>
                        <li>1からn-1の範囲で乱数dをランダムに選択する（これが秘密鍵）</li>
                    </ul>
                </li>
                <li>公開鍵の計算：
                    <ul>
                        <li>Q = dG を計算する（基点Gを秘密鍵d回スカラー倍した点）</li>
                        <li>点Qが公開鍵となる</li>
                    </ul>
                </li>
                <li>秘密鍵dは安全に保管し、公開鍵Qは公開する</li>
            </ol>
            
            <h4>3. 楕円曲線Diffie-Hellman鍵共有（ECDH）</h4>
            <ol>
                <li>アリスとボブが共有鍵を確立する場合：
                    <ul>
                        <li>アリスは秘密鍵dAを生成し、公開鍵QA = dA×Gを計算して公開する</li>
                        <li>ボブは秘密鍵dBを生成し、公開鍵QB = dB×Gを計算して公開する</li>
                    </ul>
                </li>
                <li>共有秘密の計算：
                    <ul>
                        <li>アリスはS = dA×QB = dA×dB×Gを計算する</li>
                        <li>ボブはS = dB×QA = dB×dA×Gを計算する</li>
                        <li>両者は同じ点S（共有秘密）を得る</li>
                        <li>この共有点のx座標（または点全体のハッシュ値）を共有鍵として使用する</li>
                    </ul>
                </li>
            </ol>
            
            <h4>4. 楕円曲線デジタル署名アルゴリズム（ECDSA）</h4>
            <ol>
                <li>署名生成：
                    <ul>
                        <li>メッセージmのハッシュ値e = HASH(m)を計算する</li>
                        <li>1からn-1の範囲でランダムな整数k（一時的な鍵）を選択する</li>
                        <li>R = k×Gを計算し、Rのx座標をr（mod n）とする</li>
                        <li>s = k^(-1)×(e + d×r) mod nを計算する（dは署名者の秘密鍵）</li>
                        <li>署名は(r, s)のペアとなる</li>
                    </ul>
                </li>
                <li>署名検証：
                    <ul>
                        <li>署名(r, s)と公開鍵Qを用いて、メッセージmの署名を検証する</li>
                        <li>メッセージのハッシュ値e = HASH(m)を計算する</li>
                        <li>u1 = e×s^(-1) mod n, u2 = r×s^(-1) mod nを計算する</li>
                        <li>P = u1×G + u2×Qを計算する</li>
                        <li>Pのx座標がr（mod n）と等しければ署名は有効</li>
                    </ul>
                </li>
            </ol>
            
            <h4>5. 楕円曲線統合暗号化方式（ECIES）</h4>
            <ol>
                <li>暗号化：
                    <ul>
                        <li>受信者の公開鍵Qを用いる</li>
                        <li>ランダムな値rを生成し、R = r×Gを計算する</li>
                        <li>共有秘密S = r×Qを計算する</li>
                        <li>Sから対称鍵を導出する（KDF関数を使用）</li>
                        <li>導出した対称鍵でメッセージを暗号化する</li>
                        <li>暗号文とRのペアを送信する</li>
                    </ul>
                </li>
                <li>復号：
                    <ul>
                        <li>受信者は自分の秘密鍵dと受信したRを使って共有秘密S = d×Rを計算する</li>
                        <li>同じKDFを使って対称鍵を導出する</li>
                        <li>導出した対称鍵で暗号文を復号する</li>
                    </ul>
                </li>
            </ol>
    
            <h3>計算量</h3>
            <p>楕円曲線暗号の計算量は、主要な演算と暗号操作ごとに異なります：</p>
            
            <h4>基本演算の計算量</h4>
            <ul>
                <li><strong>点の加算（Point Addition）</strong>:
                    <ul>
                        <li>有限体上での演算：O(1)（固定数の有限体演算）</li>
                        <li>アフィン座標系での実装：1回の逆元計算と複数回の乗算・加算</li>
                        <li>射影座標系での実装：逆元計算を避け、より効率的</li>
                    </ul>
                </li>
                <li><strong>点の2倍算（Point Doubling）</strong>:
                    <ul>
                        <li>有限体上での演算：O(1)（固定数の有限体演算）</li>
                        <li>特定の座標系で最適化可能</li>
                    </ul>
                </li>
                <li><strong>スカラー倍算（Scalar Multiplication）k×P</strong>:
                    <ul>
                        <li>ダブル・アンド・アド法使用時：O(log k)（kのビット長に比例）</li>
                        <li>窓法やNAF表現などの最適化で定数倍高速化可能</li>
                    </ul>
                </li>
            </ul>
            
            <h4>暗号操作の計算量</h4>
            <ul>
                <li><strong>鍵生成</strong>:
                    <ul>
                        <li>時間計算量：O(log n)（nは基点Gの位数）</li>
                        <li>主要な演算はスカラー倍算（d×G）</li>
                    </ul>
                </li>
                <li><strong>ECDH鍵共有</strong>:
                    <ul>
                        <li>時間計算量：O(log n)</li>
                        <li>各参加者は1回のスカラー倍算を実行</li>
                    </ul>
                </li>
                <li><strong>ECDSA署名生成</strong>:
                    <ul>
                        <li>時間計算量：O(log n)</li>
                        <li>1回のスカラー倍算と複数回の模倍剰余演算</li>
                    </ul>
                </li>
                <li><strong>ECDSA署名検証</strong>:
                    <ul>
                        <li>時間計算量：O(log n)</li>
                        <li>2回のスカラー倍算（マルチスカラー倍算として最適化可能）</li>
                    </ul>
                </li>
                <li><strong>ECIES暗号化/復号</strong>:
                    <ul>
                        <li>時間計算量：O(log n)＋対称暗号の計算量</li>
                        <li>各操作に1回のスカラー倍算と対称暗号処理が含まれる</li>
                    </ul>
                </li>
            </ul>
            
            <h4>空間計算量</h4>
            <ul>
                <li><strong>鍵サイズ</strong>:
                    <ul>
                        <li>秘密鍵：約n bits（nは安全性レベルに依存、一般的に256ビット）</li>
                        <li>公開鍵：約2n bits（点の座標を格納するため）</li>
                        <li>圧縮形式では約n+1 bits（x座標とyの符号ビット）</li>
                    </ul>
                </li>
                <li><strong>署名サイズ（ECDSA）</strong>: 約2n bits（r, sの2つの値）</li>
                <li><strong>暗号文サイズ（ECIES）</strong>: メッセージサイズ + 約2n bits + MACサイズ</li>
            </ul>
            
            <p>楕円曲線暗号の主な利点は、同等のセキュリティレベルを提供するための鍵サイズがRSAなどの従来の公開鍵暗号方式よりも大幅に小さいことです。例えば、256ビットのECC鍵は3072ビットのRSA鍵と同等のセキュリティを提供します。これにより、通信オーバーヘッドや記憶域の削減、そして計算効率の向上が実現します。</p>
            
            <p>楕円曲線暗号の安全性は楕円曲線離散対数問題（ECDLP）の困難さに依存しており、現在知られている最良のアルゴリズムでもO(√n)の計算量が必要です（ここでnは曲線の位数）。量子コンピュータが実用化された場合、ショアのアルゴリズムによりECDLPは多項式時間で解けるようになりますが、従来の暗号と比較して相対的に高い耐性を持つと考えられています。</p>
            
            <p>実装面では、楕円曲線暗号は様々な最適化技術（窓法、NAF表現、事前計算テーブル、特殊な座標系など）により高速化することが可能です。また、特定のハードウェアアクセラレーションを活用することで、さらなるパフォーマンスの向上が期待できます。</p>
        </div>
    </div>
</body>
</html>