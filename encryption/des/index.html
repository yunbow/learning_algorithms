<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DES (Data Encryption Standard)</title>
    <link rel="stylesheet" href="./../../styles.css">
</head>
<body>
    <ul class="breadcrumb">
        <li><a href="./../../">アルゴリズムの学習</a></li>
        <li><a href="./../">暗号化・複合化の問題</a></li>
        <li>DES</li>
    </ul>

    <div class="container">
        <h1>DES (Data Encryption Standard)</h1>
        <div class="section">
            <h2>アルゴリズムの概要</h2>
            <p>DES（Data Encryption Standard）は、1970年代に米国国立標準技術研究所（NIST、当時はNBS）によって標準化された対称鍵ブロック暗号アルゴリズムです。1977年に米国連邦情報処理標準（FIPS）として採用され、その後約20年間にわたり世界中で広く使用されました。DESは64ビットのブロックサイズと56ビットの鍵サイズ（実質的には56ビット、表記上は64ビット）を持つFeistel構造ベースの暗号です。</p>
            
            <h3>基礎知識</h3>
            <p>DESは対称鍵暗号の一種で、同一の鍵を用いて暗号化と復号化の両方を行います。その中核はFeistel構造と呼ばれるネットワーク設計に基づいており、データを左右の半分に分割し、複数のラウンドにわたって処理を繰り返すことで暗号化を実現します。DESは16ラウンドのFeistel構造を採用しています。</p>
            <p>現在のセキュリティ基準では、DESの56ビット鍵は短すぎるとされ、総当たり攻撃に対して脆弱と考えられています。そのため、セキュリティを強化した3DES（Triple DES）や、より新しいAES（Advanced Encryption Standard）など、より強力な暗号アルゴリズムに置き換えられつつあります。ただし、歴史的重要性や教育的価値から、暗号理論の学習において現在も重要な位置を占めています。</p>
            
            <h3>用語説明</h3>
            <ul>
                <li><strong>ブロック暗号</strong>: 固定サイズのブロック単位でデータを暗号化する方式</li>
                <li><strong>対称鍵暗号</strong>: 暗号化と復号化に同じ鍵を使用する暗号方式</li>
                <li><strong>Feistel構造</strong>: データを左右に分割し、ラウンド関数と鍵を使って交互に処理する暗号構造</li>
                <li><strong>ラウンド</strong>: 暗号化処理の基本単位で、同じ処理を繰り返す一連の操作</li>
                <li><strong>サブキー（ラウンドキー）</strong>: 各ラウンドで使用される、主鍵から生成された派生鍵</li>
                <li><strong>初期置換（IP）</strong>: 暗号化前にビット位置を並べ替える操作</li>
                <li><strong>最終置換（FP）</strong>: 暗号化後にビット位置を並べ替える操作（初期置換の逆）</li>
                <li><strong>拡張置換（E）</strong>: 32ビットのデータを48ビットに拡張する操作</li>
                <li><strong>S-box（置換ボックス）</strong>: 非線形変換を行うテーブル、DESでは8つのS-boxを使用</li>
                <li><strong>P-box（置換ボックス）</strong>: ビット位置を並べ替える線形変換</li>
                <li><strong>鍵スケジュール</strong>: 主鍵から各ラウンドで使用するサブキーを生成するアルゴリズム</li>
                <li><strong>総当たり攻撃</strong>: すべての可能な鍵を試す攻撃方法</li>
                <li><strong>3DES（Triple DES）</strong>: DESを3回適用することでセキュリティを強化した暗号方式</li>
                <li><strong>ECB/CBC/CFB/OFB/CTR</strong>: DESなどのブロック暗号を使用する際の様々な運用モード</li>
            </ul>
            
            <h3>特徴</h3>
            <p>DES暗号の主な特徴は以下の通りです：</p>
            <ul>
                <li>64ビットのブロックサイズ（一度に処理するデータ量）</li>
                <li>56ビットの実効鍵長（パリティビットを含めて64ビットで表現）</li>
                <li>16ラウンドのFeistel構造による処理</li>
                <li>初期置換（IP）と最終置換（FP）によるビット並べ替え</li>
                <li>非線形変換を行う8つのS-boxの使用</li>
                <li>各ラウンドで異なるサブキーを使用</li>
                <li>暗号化と復号化のアルゴリズムがほぼ同一（サブキーの順序が逆）</li>
                <li>アバランシェ効果（入力の小さな変化が出力に大きく影響する特性）</li>
                <li>ハードウェア実装に適した設計</li>
                <li>現代の計算能力では総当たり攻撃に脆弱</li>
                <li>線形解読法や差分解読法などの暗号解析手法の発展に貢献</li>
                <li>様々な運用モード（ECB, CBC, CFB, OFB, CTR）をサポート</li>
                <li>複数回適用による強化版（3DES）が存在</li>
                <li>暗号理論の発展に大きく貢献した歴史的に重要なアルゴリズム</li>
            </ul>
            
            <h3>適用ケース</h3>
            <p>DESは以下のような場面で使用されてきました（現在は多くの場合、より強力な暗号に置き換えられています）：</p>
            <ul>
                <li>金融データの保護（ATMや銀行システムなど）</li>
                <li>政府機関での機密情報の保護</li>
                <li>通信プロトコルでのデータ暗号化</li>
                <li>スマートカードや組み込みシステムでの情報保護</li>
                <li>セキュアな通信チャネルの確立</li>
                <li>DESの強化版である3DESを用いた重要データの保護</li>
                <li>レガシーシステムでの暗号化処理</li>
                <li>教育機関での暗号理論の教材</li>
                <li>AESへの移行過程における過渡的な暗号として</li>
                <li>互換性が重要なシステムでのデータ保護</li>
                <li>計算リソースが限られた環境での暗号化</li>
                <li>ハードウェア暗号化モジュールでの実装</li>
                <li>ファイルシステムの暗号化</li>
                <li>データのデジタル著作権管理（DRM）</li>
            </ul>
        </div>
    
        <div class="section">
            <h2>アルゴリズムの手順</h2>
            <h3>具体的な手順</h3>
            <p>DES暗号化アルゴリズムは、以下の手順で実行されます：</p>
            
            <h4>1. 鍵スケジュール（サブキー生成）</h4>
            <ol>
                <li>64ビットの入力鍵から、8ビット目ごとのパリティビットを除去し、56ビットの有効鍵を得る</li>
                <li>56ビットの鍵を置換選択1（PC-1）を用いて並べ替え、28ビットずつのC0とD0に分割する</li>
                <li>各ラウンドi（1から16）で、前段階のCi-1とDi-1を左に循環シフトし、新たなCiとDiを生成する
                    <ul>
                        <li>シフト量はラウンドによって異なり、1, 2, 9, 16ラウンドでは1ビット、その他のラウンドでは2ビット</li>
                    </ul>
                </li>
                <li>CiとDiを結合し、置換選択2（PC-2）を用いて48ビットのサブキーKiを生成する</li>
                <li>全16ラウンド分のサブキーを生成する</li>
            </ol>
            
            <h4>2. 暗号化プロセス</h4>
            <ol>
                <li>64ビットの平文を初期置換（IP）を用いて並べ替える</li>
                <li>並べ替えられたデータを左半分（L0）と右半分（R0）の32ビットずつに分割する</li>
                <li>16ラウンドの処理を行う：
                    <ul>
                        <li>各ラウンドi（1から16）で以下の処理を行う：
                            <ol>
                                <li>Li = Ri-1</li>
                                <li>Ri = Li-1 ⊕ F(Ri-1, Ki)
                                    <ul>
                                        <li>Fはラウンド関数で、以下の手順で計算：
                                            <ol>
                                                <li>Ri-1（32ビット）を拡張置換（E）で48ビットに拡張</li>
                                                <li>拡張されたデータとサブキーKi（48ビット）とのXOR演算</li>
                                                <li>結果の48ビットを6ビットずつ8グループに分割し、各グループをS-box（S1～S8）に通して4ビットに圧縮（非線形変換）</li>
                                                <li>得られた32ビットのデータをP-boxで並び替え（置換）</li>
                                            </ol>
                                        </li>
                                    </ul>
                                </li>
                            </ol>
                        </li>
                    </ul>
                </li>
                <li>16ラウンド後、L16とR16を交換し、R16|L16（結合）とする</li>
                <li>R16|L16に最終置換（FP）を適用し、64ビットの暗号文を得る</li>
            </ol>
            
            <h4>3. 復号化プロセス</h4>
            <ol>
                <li>暗号化と同じアルゴリズムを使用するが、サブキーの順序を逆にする（K16, K15, ..., K1）</li>
                <li>暗号文に初期置換（IP）を適用</li>
                <li>16ラウンドの処理を行う（サブキーの順序が逆）</li>
                <li>L16とR16を交換</li>
                <li>最終置換（FP）を適用して平文を得る</li>
            </ol>
            
            <h4>Feistel構造の特性</h4>
            <p>DESがFeistel構造を採用していることで、暗号化と復号化の処理が非常に類似しており、実装が容易になっています。復号化は暗号化と同じアルゴリズムで、サブキーの順序を逆にするだけで実現できます。これはFeistel構造の一般的な特性であり、ラウンド関数Fの可逆性を必要としないため、設計の自由度が高いという利点があります。</p>
    
            <h3>計算量</h3>
            <p>DESアルゴリズムの計算量は以下の通りです：</p>
            
            <h4>時間計算量</h4>
            <ul>
                <li><strong>鍵スケジュール（前処理）</strong>:
                    <ul>
                        <li>O(1) - 固定サイズの鍵から固定数のサブキーを生成</li>
                        <li>具体的には、16個のサブキーを生成するための定数時間の処理</li>
                    </ul>
                </li>
                <li><strong>暗号化/復号化（1ブロックあたり）</strong>: O(1)
                    <ul>
                        <li>64ビットの固定サイズブロックに対する16ラウンドの固定処理</li>
                        <li>各ラウンドは定数時間の操作（XOR、S-box参照、置換など）</li>
                    </ul>
                </li>
                <li><strong>メッセージ全体の処理</strong>: O(n)
                    <ul>
                        <li>n：メッセージのビット数（またはブロック数）</li>
                        <li>各ブロックを独立して処理するため線形</li>
                    </ul>
                </li>
            </ul>
            
            <h4>空間計算量</h4>
            <ul>
                <li><strong>鍵スケジュール</strong>: O(1)
                    <ul>
                        <li>16個のサブキー（各48ビット）を格納するための固定サイズのメモリ</li>
                    </ul>
                </li>
                <li><strong>暗号化/復号化処理</strong>: O(1)
                    <ul>
                        <li>状態情報を格納するための固定サイズのバッファ</li>
                        <li>S-box、P-box、その他の置換テーブルなどの固定サイズのデータ構造</li>
                    </ul>
                </li>
                <li><strong>メッセージ全体の処理</strong>: O(n)
                    <ul>
                        <li>入力データと出力データを格納するためのメモリ</li>
                        <li>運用モード（CBC、CTRなど）によっては追加のバッファが必要</li>
                    </ul>
                </li>
            </ul>
            
            <h4>セキュリティ計算量（攻撃の観点）</h4>
            <ul>
                <li><strong>総当たり攻撃</strong>: O(2^56)
                    <ul>
                        <li>56ビットの鍵空間を全て探索する必要がある</li>
                        <li>現代のハードウェアでは現実的な時間内に解読可能</li>
                    </ul>
                </li>
                <li><strong>線形解読法</strong>: O(2^43) - 約8兆回の既知平文が必要</li>
                <li><strong>差分解読法</strong>: O(2^47) - 約1,400億回の選択平文が必要</li>
            </ul>
            
            <p>DESのアルゴリズム自体は非常に効率的で、固定サイズのブロックに対する暗号化と復号化の処理は定数時間で行われます。そのため、処理速度は実装方法やハードウェア環境に大きく依存します。特にハードウェア実装において高速な処理が可能です。</p>
            
            <p>セキュリティの観点では、56ビットの鍵サイズが現代の計算能力に対して十分でなくなっているため、単体のDESは現在のセキュリティ要件を満たしていません。そのため、より鍵長の長いアルゴリズムや、DESを複数回適用する3DESなどが開発されました。しかし、3DESも処理速度の面で課題があり、現在ではAES（Advanced Encryption Standard）などの新しい暗号アルゴリズムが推奨されています。</p>
        </div>
    </div>
</body>
</html>