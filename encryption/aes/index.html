<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AES (Advanced Encryption Standard)</title>
    <link rel="stylesheet" href="./../../styles.css">
</head>
<body>
    <ul class="breadcrumb">
        <li><a href="./../../">アルゴリズムの学習</a></li>
        <li><a href="./../">暗号化・複合化の問題</a></li>
        <li>AES</li>
    </ul>

    <div class="container">
        <h1>AES (Advanced Encryption Standard)</h1>
        <div class="section">
            <h2>アルゴリズムの概要</h2>
            <p>AES (Advanced Encryption Standard) は、2001年に米国国立標準技術研究所 (NIST) によって採用された対称鍵暗号方式です。ベルギーの暗号学者 Joan Daemen と Vincent Rijmen によって開発された Rijndael 暗号をベースにしています。AESは現在、世界中の政府機関や企業で広く使用されている最も一般的な暗号化アルゴリズムの一つです。</p>
            
            <h3>基礎知識</h3>
            <p>AESは、ブロック暗号の一種で、固定サイズのデータブロック (128ビット) を処理します。暗号化と復号化には同じ秘密鍵を使用するため、対称鍵暗号に分類されます。AESは、鍵長に応じてAES-128、AES-192、AES-256の3つのバリエーションがあり、それぞれ128ビット、192ビット、256ビットの鍵を使用します。鍵が長いほどセキュリティレベルは高くなりますが、処理時間も増加します。</p>
            <p>AESは、置換（Substitution）と転置（Permutation）を組み合わせたSPN（Substitution-Permutation Network）構造を採用しており、複数のラウンドを通じてデータを変換します。各ラウンドでは、SubBytes、ShiftRows、MixColumns、AddRoundKeyという4つの操作が行われます。AESの強度は、これらの操作の組み合わせによる非線形性と拡散性に基づいています。</p>
            
            <h3>用語説明</h3>
            <ul>
                <li><strong>ブロック暗号</strong>: 固定長のブロック単位でデータを暗号化する暗号方式</li>
                <li><strong>対称鍵暗号</strong>: 暗号化と復号化に同じ鍵を使用する暗号方式</li>
                <li><strong>ステート</strong>: AESで処理される4×4バイト行列のデータ構造</li>
                <li><strong>ラウンド</strong>: 暗号化/復号化の1サイクルを構成する変換処理の集合</li>
                <li><strong>ラウンド鍵</strong>: 各ラウンドで使用される、元の鍵から生成された派生鍵</li>
                <li><strong>鍵スケジュール</strong>: 元の鍵から各ラウンド鍵を生成するプロセス</li>
                <li><strong>SubBytes</strong>: 非線形バイト置換を行う操作（S-box使用）</li>
                <li><strong>ShiftRows</strong>: ステート内の行をシフトする転置操作</li>
                <li><strong>MixColumns</strong>: 列ごとに線形変換を行う拡散操作</li>
                <li><strong>AddRoundKey</strong>: ステートとラウンド鍵のXOR操作</li>
                <li><strong>S-box</strong>: SubBytes操作で使用される置換テーブル</li>
                <li><strong>有限体</strong>: AESの数学的基盤となるGF(2^8)などの代数構造</li>
                <li><strong>CBC, CTR, GCM</strong>: AESと組み合わせて使用される代表的な運用モード</li>
                <li><strong>初期化ベクトル (IV)</strong>: 暗号化の開始状態を決定するランダムな値</li>
                <li><strong>パディング</strong>: ブロックサイズに満たないデータを埋める技術</li>
            </ul>
            
            <h3>特徴</h3>
            <p>AES暗号の主な特徴は以下の通りです：</p>
            <ul>
                <li>128ビットの固定ブロックサイズを採用</li>
                <li>128/192/256ビットの3種類の鍵長をサポート</li>
                <li>鍵長に応じて10/12/14ラウンドの処理を実行</li>
                <li>全てのバイトに影響を与える完全な拡散性</li>
                <li>非線形置換による強い攪拌効果</li>
                <li>数学的に解析しにくい構造</li>
                <li>ハードウェア実装に適した単純な演算のみを使用</li>
                <li>ソフトウェアでも効率的に実装可能</li>
                <li>サイドチャネル攻撃などの実装攻撃に対する脆弱性が存在するが、対策可能</li>
                <li>現時点では実用的な全数探索以外の暗号解読法は知られていない</li>
                <li>様々な運用モード（ECB, CBC, CTR, GCM等）と組み合わせて使用可能</li>
                <li>世界中の政府機関や企業による広範な検証と採用実績がある</li>
                <li>オープンな選定プロセスと公開仕様による透明性の高さ</li>
            </ul>
            
            <h3>適用ケース</h3>
            <p>AES暗号は以下のような場面で特に有用です：</p>
            <ul>
                <li>インターネット通信の暗号化（HTTPS, TLS/SSL）</li>
                <li>無線ネットワークのセキュリティ（WPA2, WPA3）</li>
                <li>VPN (Virtual Private Network) での通信保護</li>
                <li>ストレージデバイスの暗号化（ディスク暗号化）</li>
                <li>データベースのフィールドやデータの暗号化</li>
                <li>政府や軍事機関の機密情報保護</li>
                <li>金融機関のトランザクション保護</li>
                <li>デジタル著作権管理 (DRM) システム</li>
                <li>IoTデバイスのセキュリティ対策</li>
                <li>クラウドストレージでのデータ保護</li>
                <li>メッセージングアプリの端末間暗号化</li>
                <li>ブロックチェーンやデジタル通貨のセキュリティ</li>
                <li>セキュアブートやコード署名のハッシュ保護</li>
                <li>パスワードやクレジットカード情報の保管</li>
            </ul>
        </div>
    
        <div class="section">
            <h2>アルゴリズムの手順</h2>
            <h3>具体的な手順</h3>
            <p>AES暗号化アルゴリズムは、次の主要なステップで構成されています：</p>
            
            <h4>1. 準備段階</h4>
            <ol>
                <li>鍵拡張（Key Expansion）:
                    <ul>
                        <li>元の秘密鍵から各ラウンドで使用するラウンド鍵を生成する</li>
                        <li>鍵スケジュールアルゴリズムを使用して拡張</li>
                        <li>AES-128は11個、AES-192は13個、AES-256は15個のラウンド鍵を生成</li>
                    </ul>
                </li>
                <li>初期データ配置:
                    <ul>
                        <li>平文の128ビット（16バイト）を4×4のバイト行列（ステート）に配置</li>
                        <li>バイトは列優先順序で配置される</li>
                    </ul>
                </li>
            </ol>
            
            <h4>2. 暗号化プロセス</h4>
            <ol>
                <li>初期ラウンド（ラウンド0）:
                    <ul>
                        <li>AddRoundKey: ステートと最初のラウンド鍵をXOR</li>
                    </ul>
                </li>
                <li>主要ラウンド（ラウンド1～N-1）:
                    <ul>
                        <li>SubBytes: 各バイトをS-boxを使用して非線形変換
                            <ul>
                                <li>各バイトを別の値に置き換えるルックアップテーブルを使用</li>
                                <li>この操作が暗号の非線形性を提供</li>
                            </ul>
                        </li>
                        <li>ShiftRows: ステートの各行を異なるオフセットで循環シフト
                            <ul>
                                <li>1行目: シフトなし</li>
                                <li>2行目: 1バイト左にシフト</li>
                                <li>3行目: 2バイト左にシフト</li>
                                <li>4行目: 3バイト左にシフト</li>
                            </ul>
                        </li>
                        <li>MixColumns: 各列に対して行列乗算による線形変換
                            <ul>
                                <li>ガロア体GF(2^8)上の行列乗算を使用</li>
                                <li>1バイトの変更が列全体に影響する拡散効果を生み出す</li>
                            </ul>
                        </li>
                        <li>AddRoundKey: ステートと現在のラウンド鍵をXOR</li>
                    </ul>
                </li>
                <li>最終ラウンド（ラウンドN）:
                    <ul>
                        <li>SubBytes: 通常通りS-boxで置換</li>
                        <li>ShiftRows: 通常通り行をシフト</li>
                        <li>AddRoundKey: 最後のラウンド鍵とXOR（MixColumnsは行わない）</li>
                    </ul>
                </li>
            </ol>
            <p>なお、ラウンド数Nは鍵長によって異なります：AES-128では10ラウンド、AES-192では12ラウンド、AES-256では14ラウンドとなります。</p>
            
            <h4>3. 復号化プロセス</h4>
            <p>復号化は暗号化の逆操作を行います：</p>
            <ol>
                <li>初期ラウンド:
                    <ul>
                        <li>AddRoundKey: 暗号文と最後のラウンド鍵をXOR</li>
                        <li>InvShiftRows: ShiftRowsの逆操作</li>
                        <li>InvSubBytes: SubBytesの逆操作（逆S-box使用）</li>
                    </ul>
                </li>
                <li>主要ラウンド:
                    <ul>
                        <li>AddRoundKey: 対応するラウンド鍵とXOR</li>
                        <li>InvMixColumns: MixColumnsの逆操作</li>
                        <li>InvShiftRows: 行を逆方向にシフト</li>
                        <li>InvSubBytes: 逆S-boxを使用</li>
                    </ul>
                </li>
                <li>最終ラウンド:
                    <ul>
                        <li>AddRoundKey: 最初のラウンド鍵とXOR</li>
                    </ul>
                </li>
            </ol>
    
            <h4>例：AES-128によるデータブロックの暗号化</h4>
            <p>128ビットのデータブロック（16バイト）を128ビットの鍵で暗号化する例を考えます：</p>
            <ol>
                <li>鍵スケジュールにより10個のラウンド鍵を生成</li>
                <li>データを4×4のステート行列に配置</li>
                <li>初期AddRoundKeyでステートと最初のラウンド鍵をXOR</li>
                <li>9回の主要ラウンドを実行:
                    <ul>
                        <li>各バイトをS-boxで置換</li>
                        <li>各行を指定のオフセットでシフト</li>
                        <li>各列にMixColumns変換を適用</li>
                        <li>ステートと対応するラウンド鍵をXOR</li>
                    </ul>
                </li>
                <li>最終ラウンドを実行（MixColumnsなし）</li>
                <li>結果の4×4行列から暗号文を取得</li>
            </ol>
    
            <h3>計算量</h3>
            <p>AES暗号アルゴリズムの計算量は以下の通りです：</p>
            
            <h4>時間計算量</h4>
            <ul>
                <li><strong>鍵スケジュール（前処理）</strong>:
                    <ul>
                        <li>AES-128: O(10) = O(1)</li>
                        <li>AES-192: O(12) = O(1)</li>
                        <li>AES-256: O(14) = O(1)</li>
                        <li>固定サイズの操作のため、定数時間</li>
                    </ul>
                </li>
                <li><strong>一つのブロックの暗号化/復号化</strong>: O(1)
                    <ul>
                        <li>ブロックサイズ固定（128ビット）、ラウンド数固定</li>
                        <li>各ラウンドは固定数の操作で構成</li>
                    </ul>
                </li>
                <li><strong>大きなデータの暗号化</strong>: O(n)
                    <ul>
                        <li>n：データサイズ（バイト数）</li>
                        <li>データをブロックに分割して処理するため、線形時間</li>
                    </ul>
                </li>
            </ul>
            
            <h4>空間計算量</h4>
            <ul>
                <li><strong>ステート行列</strong>: O(1)
                    <ul>
                        <li>常に4×4バイト = 16バイト（128ビット）</li>
                    </ul>
                </li>
                <li><strong>ラウンド鍵</strong>: O(1)
                    <ul>
                        <li>AES-128: 11個のラウンド鍵 = 176バイト</li>
                        <li>AES-192: 13個のラウンド鍵 = 208バイト</li>
                        <li>AES-256: 15個のラウンド鍵 = 240バイト</li>
                    </ul>
                </li>
                <li><strong>S-box/逆S-box</strong>: O(1)
                    <ul>
                        <li>各256バイト（固定サイズ）</li>
                    </ul>
                </li>
                <li><strong>全体の空間計算量</strong>: O(1)
                    <ul>
                        <li>入力サイズに関係なく固定量のメモリを使用</li>
                    </ul>
                </li>
            </ul>
            
            <p>AESの重要な特性は、暗号化や復号化の操作がブロックサイズに対して固定時間であることです。つまり、一つのブロックを処理する時間は常に一定です。大きなデータを処理する場合は、データサイズに比例した時間がかかりますが、これは単にブロック数に比例するためです。</p>
            
            <p>実装面では、AESはハードウェアレベルでの最適化が可能で、多くのモダンCPUには専用のAES命令セット（AES-NI）が搭載されています。これにより、ソフトウェア実装と比較して数倍から数十倍の高速化が実現できます。また、並列処理が可能な運用モード（CTRなど）を使用することで、マルチコアプロセッサでの効率的な処理も可能です。</p>
            
            <p>セキュリティの観点では、AES-128でも現在の計算能力では全数探索（2^128の鍵空間）は現実的ではなく、理論的に安全とされています。より高いセキュリティが必要な場合はAES-256を使用することが推奨されますが、処理速度とのトレードオフとなります。なお、純粋な暗号アルゴリズムとしてのAESに対する実用的な攻撃は知られていませんが、実装方法によってはサイドチャネル攻撃などのリスクがあるため、適切な対策が必要です。</p>
        </div>
    </div>
</body>
</html>