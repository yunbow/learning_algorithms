<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>幅優先探索 (BFS)</title>
    <link rel="stylesheet" href="./../../styles.css">
</head>
<body>
    <ul class="breadcrumb">
        <li><a href="./../../">アルゴリズムの学習</a></li>
        <li><a href="./../">グラフの連結成分問題</a></li>
        <li>幅優先探索</li>
    </ul>
    <div class="container">
        <h1>幅優先探索 (BFS)</h1>
        <div class="section">
            <h2>アルゴリズムの概要</h2>
            <p>グラフの連結成分とは、グラフ内のすべての頂点が互いに到達可能であるような最大の部分グラフのことを指します。無向グラフにおいては、すべての頂点間に経路が存在する部分グラフを連結成分と呼びます。有向グラフでは、強連結成分と弱連結成分に分けられます。幅優先探索（BFS）はグラフの連結成分を特定するための効率的なアルゴリズムの一つです。</p>
            
            <h3>基礎知識</h3>
            <p>幅優先探索（BFS）は、グラフやツリーの探索アルゴリズムで、ルートノードから始めて、隣接するすべてのノードを先に訪問してから次のレベルに進むという特徴があります。BFSを利用することで、グラフ内の連結された頂点のグループ（連結成分）を効率的に特定することができます。</p>
            <p>BFSはキューを使用して実装され、まず開始頂点をキューに入れ、キューから頂点を取り出して処理し、その頂点に隣接する未訪問の頂点をすべてキューに追加する、という手順を繰り返します。この過程で訪問されたすべての頂点が一つの連結成分を形成します。</p>
            
            <h3>用語説明</h3>
            <ul>
                <li><strong>連結成分（Connected Component）</strong>: グラフ内のすべての頂点間に経路が存在する最大の部分グラフ</li>
                <li><strong>幅優先探索（BFS: Breadth-First Search）</strong>: 同じ深さのノードを先に訪問してから次の深さに進むグラフ探索アルゴリズム</li>
                <li><strong>キュー（Queue）</strong>: 先入れ先出し（FIFO）のデータ構造で、BFSの実装に使用される</li>
                <li><strong>訪問マーク（Visited Mark）</strong>: 頂点が既に訪問されたかどうかを記録するフラグ</li>
                <li><strong>隣接リスト（Adjacency List）</strong>: 各頂点に隣接する頂点のリストを保持するグラフ表現</li>
                <li><strong>隣接行列（Adjacency Matrix）</strong>: 頂点間の接続関係を行列で表現するグラフ表現</li>
                <li><strong>無向グラフ（Undirected Graph）</strong>: エッジに方向性がないグラフ</li>
                <li><strong>有向グラフ（Directed Graph）</strong>: エッジに方向性があるグラフ</li>
                <li><strong>強連結成分（Strongly Connected Component）</strong>: 有向グラフにおいて、任意の2頂点間に双方向の経路が存在する部分グラフ</li>
                <li><strong>弱連結成分（Weakly Connected Component）</strong>: 有向グラフにおいて、エッジの向きを無視したときに連結となる部分グラフ</li>
            </ul>
            
            <h3>特徴</h3>
            <p>BFSを用いたグラフの連結成分探索の主な特徴は以下の通りです：</p>
            <ul>
                <li>レベル順探索により、開始頂点からの最短経路を自然に発見できる</li>
                <li>キューを使用した明確で効率的な実装が可能</li>
                <li>メモリ使用量はグラフのサイズに比例する（全頂点の訪問状態を記録する必要がある）</li>
                <li>無向グラフと有向グラフの両方に適用可能</li>
                <li>一度の実行で一つの連結成分を完全に特定できる</li>
                <li>すべての連結成分を見つけるには、未訪問の頂点ごとにBFSを繰り返す必要がある</li>
                <li>連結成分の数だけでなく、各連結成分のサイズや構成も特定できる</li>
                <li>グラフの密度に関わらず、すべての頂点とエッジを確実に探索する</li>
                <li>連結成分内の各頂点からの距離情報も同時に計算可能</li>
            </ul>
            
            <h3>適用ケース</h3>
            <p>グラフの連結成分を見つけるためのBFSは、以下のような場面で特に有用です：</p>
            <ul>
                <li>ソーシャルネットワーク内のコミュニティ検出</li>
                <li>画像処理における領域分割や連結領域の検出</li>
                <li>ネットワークの信頼性分析（ネットワークが複数の独立した部分に分かれているかどうか）</li>
                <li>生物学的ネットワーク（タンパク質相互作用ネットワークなど）の解析</li>
                <li>道路ネットワークにおける分断された地域の特定</li>
                <li>電気回路の独立した回路の特定</li>
                <li>クラスタリングアルゴリズムの一部として</li>
                <li>Webクローリングにおける関連ページのグループ化</li>
                <li>グラフの連結性テスト（グラフが連結しているかどうかの確認）</li>
                <li>災害時の避難経路計画（分断された地域の特定）</li>
                <li>コンピュータネットワークの分割検出</li>
            </ul>
        </div>
    
        <div class="section">
            <h2>アルゴリズムの手順</h2>
            <h3>具体的な手順</h3>
            <p>BFSを使用してグラフの連結成分を見つける具体的な手順は以下の通りです：</p>
            
            <h4>1. 前準備</h4>
            <ol>
                <li>すべての頂点を「未訪問」としてマークする</li>
                <li>連結成分のカウンタを0に初期化する</li>
                <li>必要に応じて、各頂点がどの連結成分に属するかを記録する配列を用意する</li>
            </ol>
            
            <h4>2. 各連結成分の発見</h4>
            <ol>
                <li>グラフのすべての頂点について以下を繰り返す：
                    <ul>
                        <li>現在の頂点が既に訪問済みの場合は、次の頂点に進む</li>
                        <li>未訪問の頂点を見つけたら、連結成分のカウンタをインクリメントする</li>
                        <li>その頂点を開始点として、BFSを実行して連結成分全体を探索する（次のステップ）</li>
                    </ul>
                </li>
            </ol>
            
            <h4>3. 単一連結成分のBFS探索</h4>
            <ol>
                <li>空のキューを作成する</li>
                <li>開始頂点を「訪問済み」としてマークし、現在の連結成分IDを割り当てる</li>
                <li>開始頂点をキューに追加する</li>
                <li>キューが空になるまで以下を繰り返す：
                    <ul>
                        <li>キューから頂点を取り出す（デキュー）</li>
                        <li>取り出した頂点に隣接するすべての頂点について：
                            <ul>
                                <li>隣接頂点が未訪問の場合：
                                    <ul>
                                        <li>隣接頂点を「訪問済み」としてマークする</li>
                                        <li>隣接頂点に現在の連結成分IDを割り当てる</li>
                                        <li>隣接頂点をキューに追加する（エンキュー）</li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ol>
            
            <h4>4. 結果の整理</h4>
            <ol>
                <li>連結成分の総数（カウンタの最終値）を取得する</li>
                <li>必要に応じて、各連結成分のサイズや構成を計算する</li>
                <li>各頂点がどの連結成分に属するかの情報を返す</li>
            </ol>
    
            <h3>計算量</h3>
            <p>BFSを使用したグラフの連結成分探索の計算量は以下の通りです：</p>
            
            <h4>時間計算量</h4>
            <ul>
                <li><strong>全体の時間計算量</strong>: O(V + E)
                    <ul>
                        <li>V はグラフの頂点数</li>
                        <li>E はグラフのエッジ数</li>
                    </ul>
                </li>
                <li><strong>理由</strong>:
                    <ul>
                        <li>各頂点は正確に1回訪問される（O(V)）</li>
                        <li>各エッジは最大2回考慮される（各端点から1回ずつ）（O(E)）</li>
                        <li>キューの操作（エンキューとデキュー）は頂点ごとに定数時間で行われる</li>
                    </ul>
                </li>
                <li><strong>グラフ表現による差異</strong>:
                    <ul>
                        <li>隣接リスト表現: O(V + E)</li>
                        <li>隣接行列表現: O(V²)（各頂点の隣接頂点を見つけるのにO(V)かかるため）</li>
                    </ul>
                </li>
            </ul>
            
            <h4>空間計算量</h4>
            <ul>
                <li><strong>全体の空間計算量</strong>: O(V)
                    <ul>
                        <li>訪問マーク配列: O(V)</li>
                        <li>連結成分ID配列: O(V)</li>
                        <li>キュー: 最悪の場合O(V)（すべての頂点が同時にキューに入る場合）</li>
                    </ul>
                </li>
                <li><strong>グラフ表現のための追加空間</strong>:
                    <ul>
                        <li>隣接リスト: O(V + E)</li>
                        <li>隣接行列: O(V²)</li>
                    </ul>
                </li>
            </ul>
            
            <p>このアルゴリズムは、グラフのすべての頂点とエッジを1回だけ訪問するため、大規模なグラフでも効率的に動作します。特に疎なグラフ（頂点数に比べてエッジ数が少ないグラフ）では、隣接リスト表現を使用することで効率性が向上します。</p>
            
            <p>実際の応用では、グラフの性質や問題の要件に応じて、BFS以外にもDFS（深さ優先探索）やUnion-Find（素集合データ構造）など、他のアルゴリズムも連結成分の探索に使用されることがあります。特にUnion-Findは静的なグラフの連結成分を効率的に見つけるのに適しています。一方、BFSは連結成分内の頂点間の距離情報も同時に得られるという利点があります。</p>
        </div>
    </div>
</body>
</html>